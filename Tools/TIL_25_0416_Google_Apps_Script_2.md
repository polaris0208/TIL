# Google Apps Script 2

## 목적
- "학생 입력" 시트의 데이터를 "학생 관리" 시트에 누적/갱신
- 학생별 점수 및 피드백 관리 자동화


## 동작 흐름

- **시트 객체 가져오기**
  - 현재 스프레드시트에서 "학생 입력", "학생 관리" 시트 불러옴
  - 시트가 없으면 경고 후 종료

- **입력 데이터 유효성 검사**
  - 입력 시트에 데이터가 없으면 경고 후 종료

- **데이터 읽기**
  - 입력 시트: 2행~마지막행, 1~15열(A2:O) 읽기
  - 관리 시트: 전체 데이터 읽기

- **이름-행번호 매핑 생성**
  - 관리 시트의 이름(1열)을 키, 행 번호를 값으로 하는 Map 생성
  - 기존 학생 빠른 탐색용

- **오늘 날짜 구하기**
  - 피드백에 날짜 태그로 활용

- **입력 데이터 반복 처리**
  - 각 학생 데이터별로 다음 수행
    - 이름 없는 행은 건너뜀
    - 기존 학생이면
      - 국어~과학 점수: 기존값과 새값의 평균으로 갱신
      - 피드백(교사, 학생, 기타): 날짜와 함께 누적
      - 최신 총점 갱신
      - 총점 이력 누적
    - 신규 학생이면
      - 이름, 점수, 피드백, 총점, 총점 이력 등 새 행 추가

- **관리 시트에 데이터 반영**
  - A~J열(10열)에 전체 데이터 덮어쓰기

- **입력 시트 초기화**
  - 입력 데이터(2행~마지막, 1~15열) 모두 지움

- **완료 알림**
  - "학생 데이터가 성공적으로 업데이트되었습니다!" 메시지 표시


## 활용 포인트

- 자동화: 반복되는 학생 점수/피드백 관리 작업을 자동화
- 이력 관리: 날짜별 피드백, 점수 이력 추적 가능
- 신규/기존 자동 구분: 이름 기준으로 자동 처리
- 입력 시트 자동 초기화: 다음 입력을 위한 준비


## 사용법 요약

- "학생 입력" 시트에 데이터 입력
- 스크립트 실행 (직접 실행 또는 버튼 연결)
- "학생 관리" 시트에 데이터 누적/갱신
- 입력 시트 자동 비움


## FAQ

- Q. 시트 이름이 다르면?
  - 경고창 후 동작 중단 → 정확한 시트 이름 사용 필요
- Q. 입력 데이터가 없으면?
  - "입력된 데이터가 없습니다." 경고 후 종료
- Q. 기존 학생 점수는?
  - 기존 점수와 새 점수의 평균값으로 갱신
- Q. 피드백, 총점 이력은?
  - 날짜와 함께 누적 저장


## 활용 팁

- 트리거 설정 시 자동 실행 가능
- 버튼 만들어 스크립트 연결 가능
- 시트 구조(열 순서 등) 변경 시 스크립트 내 열 번호도 함께 수정 필요


> 궁금한 점이 있으면 언제든 질문하세요!  
> 스크립트 활용이 익숙해질 때까지 차근차근 따라해 보세요. 😊
